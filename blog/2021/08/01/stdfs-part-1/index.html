<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <meta name="author" content="RMOTW Contributors" />
    <meta name="copyright" content="RMOTW Contributors" />


<meta name="keywords" content="motw, fs, easy, path, Module of the Week, " />

    <title>std::fs (Part 1)  · Rust Module of the Week
</title>


    <link href="https://motw.rs/rss.xml" type="application/rss+xml" rel="alternate" title="Rust Module of the Week - Full RSS Feed" />
    <link href="https://motw.rs/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Rust Module of the Week - Full Atom Feed" />

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">

    <link rel="stylesheet" href="https://motw.rs/theme/css/web-min.css?2fe77f69">
    <link rel="icon" type="image/png" sizes="32x32" href="https://www.rust-lang.org/static/images/favicon-32x32.png">
    <link rel="icon" type="image/svg+xml" href="https://www.rust-lang.org/static/images/favicon.svg">
    <link rel="mask-icon" href="https://www.rust-lang.org/static/images/safari-pinned-tab.svg" color="#000">

  </head>
  <body>
    <header class="site-header">
      <div class="container wrapper">
        <a class="site-title" href="https://motw.rs/">Rust Module of the Week</a>
      </div>
    </header>

    <div class="page-content">
      <div class="container wrapper">
<div class="post">
  <header class="post-header">
<div class="row post-title">
    <div class="col-xs-12 col-sm-4">
      <span class="small text-muted time-prefix">
        <time pubdate="pubdate" datetime="2021-08-01T09:58:00-04:00">01 AUG 2021</time>
      </span>
    </div>
    <div class="col-xs-12 col-sm-8 text-right custom-xs-text-left">
      <a href="https://motw.rs/blog/2021/08/01/stdfs-part-1/">std::fs (Part 1)</a>
    </div>
  </div>
    </header>

<div class="well">
    <div class="col-md-3">
    </div>
    <div class="col-md-6">
    <h6 class="text-center">This post is part 1 of the "std::fs" series</h6>
    </div>
    <div class="col-md-3">
        <a href='https://motw.rs/blog/2021/08/08/stdfs-part-2-dirs-dirs-dirs/'>std::fs (Part 2): Dirs, Dirs, Dirs</a>
    </div>
</div>

  <article class="post-content">
    <p>Hello and welcome to <em>Module of the Week</em>. Inspired by <a href="https://pymotw.com/3/" referrerpolicy="no-referrer" rel="noopener noreferrer" target="_blank" title="PyMOTW">PyMOTW</a> (and similar ideas), this blog series is meant to dig into some modules available when working with Rust. This will primarily cover the <a href="https://doc.rust-lang.org/std/index.html#modules" referrerpolicy="no-referrer" rel="noopener noreferrer" target="_blank" title="Standard Library">Standard Library</a> but you'll probably see some popular Crates show up once in a while as well.</p>
<p>Each issue has a bit of a story (not to the length you'd find on some Recipe sites) to guide new users and make learning a bit more fun.</p>
<p>Enough said, let's get to <code>std::fs</code>!</p>
<!-- more -->

<h1>The module</h1>
<p><a href="https://doc.rust-lang.org/std/fs/index.html" referrerpolicy="no-referrer" rel="noopener noreferrer" target="_blank" title="std::fs">std::fs</a> is the standard Rust module for interacting with a Filesystem. It handles a lot of the messy work when it comes to all the different ways that the underlying OS likes to handle files. Creating, Reading, Updating, Deleting, it's all there! Not every operation is supported by every OS, but this guide will try to remain as platform agnostic as possible. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There is a lot of overlap with <a href="rdoc::std::path::index" title="std::path">std::path</a> in all things filesystem related, but that will be the next module discussed.</p>
</div>
<h1>The story</h1>
<p><a href="https://www.fantasynamegenerators.com/dnd-orc-names.php" referrerpolicy="no-referrer" rel="noopener noreferrer" target="_blank" title="Rudgal The Delirious">Rudgal The Delirious</a> is the local Ornithologist. Armed with his trusty camera he's been tasked by the local Government to catalog and identify all of the birds in his local area. As he has to identify not only the species but the individual birds he's ended up with quite a few photos!</p>
<p>Having coded in college (he didn't end up with the title <em>The Delirious</em> for nothing), he sits down with his favorite IDE, forgets about tabs and spaces and dives right into <code>std::fs</code>.</p>
<p>Rudgal keeps all of his files in <code>/home/rudgal/birds</code>, so he'll start with that.</p>
<div class="highlight"><pre><span></span><code><span class="k">const</span><span class="w"> </span><span class="n">PHOTO_HOME</span>: <span class="kp">&amp;</span><span class="kt">str</span> <span class="o">=</span><span class="w"> </span><span class="s">&quot;/home/rudgal/birds&quot;</span><span class="p">;</span><span class="w"></span>
</code></pre></div>

<h2>Listing all of the files in a directory</h2>
<p>As an easy start, Rudgal wants to list all of the photos he's taken. Browsing through the documents, he comes across <a href="https://doc.rust-lang.org/stable/std/fs/fn.read_dir.html" title="std::fs::read_dir">std::fs::read_dir</a>.</p>
<blockquote>
<p>"Aha! An Iterator. A most important tool in Ornithology!" </p>
</blockquote>
<p>Rudgal shouts, to no one in particular.</p>
<p><code>std::fs::read_dir</code> gives you an Iterator (aptly named <a href="https://doc.rust-lang.org/stable/std/fs/struct.ReadDir.html" title="ReadDir">ReadDir</a>) of <a href="https://doc.rust-lang.org/stable/std/fs/struct.DirEntry.html" title="DirEntry">DirEntry</a> objects. More specifically it's a <a href="https://doc.rust-lang.org/stable/std/io/type.Result.html" title="io::Result">io::Result</a> of <code>DirEntry</code>, in case something goes wrong along the way.</p>
<blockquote>
<p>"I'll start with the paths of the files."</p>
</blockquote>
<div class="highlight"><pre><span></span><code><span class="k">use</span><span class="w"> </span><span class="n">std</span>::<span class="p">{</span><span class="n">fs</span><span class="p">,</span><span class="w"> </span><span class="n">io</span><span class="p">};</span><span class="w"></span>

<span class="kd">let</span><span class="w"> </span><span class="n">entries</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fs</span>::<span class="n">read_dir</span><span class="p">(</span><span class="n">PHOTO_HOME</span><span class="p">)</span><span class="o">?</span><span class="w"></span>
<span class="w">    </span><span class="p">.</span><span class="n">map</span><span class="p">(</span><span class="o">|</span><span class="n">entry_res</span><span class="o">|</span><span class="w"> </span><span class="n">entry_res</span><span class="p">.</span><span class="n">map</span><span class="p">(</span><span class="o">|</span><span class="n">entry</span><span class="o">|</span><span class="w"> </span><span class="n">entry</span><span class="p">.</span><span class="n">path</span><span class="p">()))</span><span class="w"></span>
<span class="w">    </span><span class="p">.</span><span class="n">collect</span>::<span class="o">&lt;</span><span class="nb">Result</span><span class="o">&lt;</span><span class="nb">Vec</span><span class="o">&lt;</span><span class="n">_</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">io</span>::<span class="n">Error</span><span class="o">&gt;&gt;</span><span class="p">()</span><span class="o">?</span><span class="p">;</span><span class="w"></span>

<span class="fm">println!</span><span class="p">(</span><span class="s">&quot;{:?}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">entries</span><span class="p">);</span><span class="w"></span>
</code></pre></div>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you're not familiar with the <code>?</code> syntax or <code>Result</code>s in general, stay tuned for when we dive into the <a href="https://doc.rust-lang.org/stable/std/result/index.html" title="std::result">std::result</a> module!</p>
</div>
<p>After running his program, he gets the following output:</p>
<div class="highlight"><pre><span></span><code><span class="o">[</span><span class="s2">&quot;/home/rudgal/birds/winter2010&quot;</span>,<span class="s2">&quot;/home/rudgal/birds/savalirwood&quot;</span>, <span class="s2">&quot;/home/rudgal/birds/DCIM_0001.jpg&quot;</span>, <span class="s2">&quot;/home/rudgal/birds/DCIM_0002.jpg&quot;</span>, ... <span class="s2">&quot;/home/rudgal/birds/DCIM_9999.jpg&quot;</span><span class="o">]</span>
</code></pre></div>

<p>Now he has a list of everything in the <code>PHOTO_HOME</code> directory. This includes both files and sub-directories.</p>
<h2>Filtering files in a directory</h2>
<p>Rudgal wants to sort out some of the entries from the previous section. Specifically he just wants to count the photos in the root of <code>PHOTO_HOME</code>. For that he finds his way to <a href="https://doc.rust-lang.org/stable/std/fs/fn.metadata.html" title="std::fs::metadata">std::fs::metadata</a> in the docs.</p>
<div class="highlight"><pre><span></span><code><span class="c1">// See previous section for the definition of &quot;entries&quot;</span>

<span class="kd">let</span><span class="w"> </span><span class="n">just_photos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">entries</span><span class="p">.</span><span class="n">iter</span><span class="p">()</span><span class="w"></span>
<span class="w">    </span><span class="p">.</span><span class="n">filter_map</span><span class="p">(</span><span class="o">|</span><span class="n">entry</span><span class="o">|</span><span class="w"> </span><span class="nb">Some</span><span class="p">((</span><span class="n">entry</span><span class="p">,</span><span class="w"> </span><span class="n">fs</span>::<span class="n">metadata</span><span class="p">(</span><span class="n">entry</span><span class="p">).</span><span class="n">ok</span><span class="p">()</span><span class="o">?</span><span class="p">)))</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Only select files, filtering out any directories</span>
<span class="w">    </span><span class="p">.</span><span class="n">filter</span><span class="p">(</span><span class="o">|</span><span class="p">(</span><span class="n">_</span><span class="p">,</span><span class="w"> </span><span class="n">meta</span><span class="p">)</span><span class="o">|</span><span class="w"> </span><span class="n">meta</span><span class="p">.</span><span class="n">is_file</span><span class="p">())</span><span class="w"></span>
<span class="w">    </span><span class="p">.</span><span class="n">collect</span>::<span class="o">&lt;</span><span class="nb">Vec</span><span class="o">&lt;</span><span class="n">_</span><span class="o">&gt;&gt;</span><span class="p">();</span><span class="w"></span>

<span class="fm">println!</span><span class="p">(</span><span class="s">&quot;There are {} actual files.&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">just_photos</span><span class="p">.</span><span class="n">len</span><span class="p">());</span><span class="w"></span>
</code></pre></div>

<p>Satisfied with his <code>Vec</code> of <code>(path, metadata)</code> pairs, Rudgal gave it a spin.</p>
<div class="highlight"><pre><span></span><code>There are <span class="m">9999</span> actual files.
</code></pre></div>

<blockquote>
<p>"A perfectly sized collection of fauna!"</p>
</blockquote>
<h2>Getting the size of a file</h2>
<p>Now that he had a list of just the photos in <code>PHOTO_HOME</code>, Rudgal wanted to know how much space all of the files were taking up. Luckily, <a href="https://doc.rust-lang.org/stable/std/fs/struct.Metadata.html" title="std::fs::Metadata">std::fs::Metadata</a> had something for just such an occasion!</p>
<div class="highlight"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="n">photo_size</span>:<span class="kt">u64</span> <span class="o">=</span><span class="w"> </span><span class="n">just_photos</span><span class="p">.</span><span class="n">iter</span><span class="p">()</span><span class="w"></span>
<span class="w">    </span><span class="p">.</span><span class="n">map</span><span class="p">(</span><span class="o">|</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="n">meta</span><span class="p">)</span><span class="o">|</span><span class="w"> </span><span class="n">meta</span><span class="p">.</span><span class="n">len</span><span class="p">())</span><span class="w"></span>
<span class="w">    </span><span class="p">.</span><span class="n">sum</span><span class="p">();</span><span class="w"></span>

<span class="fm">println!</span><span class="p">(</span><span class="s">&quot;Total size is {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">photo_size</span><span class="p">);</span><span class="w"></span>
</code></pre></div>

<div class="highlight"><pre><span></span><code>Total size is <span class="m">127190000</span>
</code></pre></div>

<blockquote>
<p>"Maybe I should organize some of this."</p>
</blockquote>
<p>Back to the docs, Rudgal!</p>
<h2>Get all files in a directory</h2>
<p>Rudgal quickly realized he had a problem. By filtering for just files from his original list, he's left out a number of directories left over from some previous half-hearted attempts to organize his photos.</p>
<p>There are two approaches that one could take when it comes to walking directories in Rust, so let's take a look at what they'd look like!</p>
<h3>Get all files in a directory (Iteratively)</h3>
<p>Rudgal wanted to start simple, to prove that he could defeat the mighty Directory beast!</p>
<div class="highlight"><pre><span></span><code><span class="k">use</span><span class="w"> </span><span class="n">std</span>::<span class="n">path</span>::<span class="p">{</span><span class="n">Path</span><span class="p">,</span><span class="w"> </span><span class="n">PathBuf</span><span class="p">};</span><span class="w"></span>

<span class="k">fn</span> <span class="nf">iter_dirs</span><span class="p">(</span><span class="n">dir</span>: <span class="kp">&amp;</span><span class="nc">Path</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">io</span>::<span class="nb">Result</span><span class="o">&lt;</span><span class="nb">Vec</span><span class="o">&lt;</span><span class="n">PathBuf</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">stack</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="fm">vec!</span><span class="p">[</span><span class="n">fs</span>::<span class="n">read_dir</span><span class="p">(</span><span class="n">dir</span><span class="p">)</span><span class="o">?</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="fm">vec!</span><span class="p">[];</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Look out for our future dive into Vectors and their various uses!</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="kd">let</span><span class="w"> </span><span class="nb">Some</span><span class="p">(</span><span class="n">dir</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stack</span><span class="p">.</span><span class="n">last_mut</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="c1">// Transpose says: Take that Option&lt;Result&gt; and turn it into a Result&lt;Option&gt;!</span>
<span class="w">        </span><span class="k">match</span><span class="w"> </span><span class="n">dir</span><span class="p">.</span><span class="n">next</span><span class="p">().</span><span class="n">transpose</span><span class="p">()</span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nb">None</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="n">stack</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">            </span><span class="c1">// A Some! But only if it&#39;s the kind of Some we want</span>
<span class="w">            </span><span class="nb">Some</span><span class="p">(</span><span class="n">dir</span><span class="p">)</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">dir</span><span class="p">.</span><span class="n">file_type</span><span class="p">().</span><span class="n">map_or</span><span class="p">(</span><span class="kc">false</span><span class="p">,</span><span class="w"> </span><span class="o">|</span><span class="n">t</span><span class="o">|</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">is_dir</span><span class="p">())</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="n">stack</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">fs</span>::<span class="n">read_dir</span><span class="p">(</span><span class="n">dir</span><span class="p">.</span><span class="n">path</span><span class="p">())</span><span class="o">?</span><span class="p">);</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">            </span><span class="nb">Some</span><span class="p">(</span><span class="n">file</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">files</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">file</span><span class="p">.</span><span class="n">path</span><span class="p">()),</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="nb">Ok</span><span class="p">(</span><span class="n">files</span><span class="p">)</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="o">..</span><span class="p">.</span><span class="w"></span>

<span class="kd">let</span><span class="w"> </span><span class="n">iter_files</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iter_dirs</span><span class="p">(</span><span class="o">&amp;</span><span class="n">PathBuf</span>::<span class="n">from</span><span class="p">(</span><span class="n">PHOTO_HOME</span><span class="p">))</span><span class="o">?</span><span class="p">;</span><span class="w"></span>
<span class="fm">println!</span><span class="p">(</span><span class="s">&quot;The number of files (iteratively) is {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">iter_files</span><span class="p">.</span><span class="n">len</span><span class="p">());</span><span class="w"></span>
</code></pre></div>

<p>There! It takes a bit of juggling what with the <code>Result</code>s and the <code>Option</code>s but he got there in the end. Bolstered by his (possibly unfounded) confidence he decided to get fancy with it.</p>
<h3>Get all files in a directory (Recursively)</h3>
<blockquote>
<p>"Recursion! The cause of, and solution to, all of life's problems!"</p>
</blockquote>
<p>Said Rudgal the Delirious.</p>
<p>Digging deep into his memory of his Algorithms classes, he made another attempt at digging through all of the directories:</p>
<div class="highlight"><pre><span></span><code><span class="k">use</span><span class="w"> </span><span class="n">std</span>::<span class="n">path</span>::<span class="p">{</span><span class="n">Path</span><span class="p">,</span><span class="w"> </span><span class="n">PathBuf</span><span class="p">};</span><span class="w"></span>

<span class="k">fn</span> <span class="nf">recurse_dirs</span><span class="p">(</span><span class="n">dir</span>: <span class="kp">&amp;</span><span class="nc">Path</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">io</span>::<span class="nb">Result</span><span class="o">&lt;</span><span class="nb">Vec</span><span class="o">&lt;</span><span class="n">PathBuf</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="fm">vec!</span><span class="p">[];</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">dir</span><span class="p">.</span><span class="n">is_dir</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">dir_files</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="fm">vec!</span><span class="p">[];</span><span class="w"></span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">fs</span>::<span class="n">read_dir</span><span class="p">(</span><span class="n">dir</span><span class="p">)</span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">entry</span><span class="o">?</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">entry</span><span class="p">.</span><span class="n">path</span><span class="p">();</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">path</span><span class="p">.</span><span class="n">is_dir</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="n">files</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">recurse_dirs</span><span class="p">(</span><span class="o">&amp;</span><span class="n">path</span><span class="p">)</span><span class="o">?</span><span class="p">);</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="n">dir_files</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">path</span><span class="p">);</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="n">files</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">dir_files</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="nb">Ok</span><span class="p">(</span><span class="n">files</span><span class="p">.</span><span class="n">into_iter</span><span class="p">().</span><span class="n">flatten</span><span class="p">().</span><span class="n">collect</span><span class="p">())</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="o">..</span><span class="p">.</span><span class="w"></span>

<span class="kd">let</span><span class="w"> </span><span class="n">recurse_files</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">recurse_dirs</span><span class="p">(</span><span class="o">&amp;</span><span class="n">PathBuf</span>::<span class="n">from</span><span class="p">(</span><span class="n">PHOTO_HOME</span><span class="p">))</span><span class="o">?</span><span class="p">;</span><span class="w"></span>
<span class="fm">println!</span><span class="p">(</span><span class="s">&quot;The number of files (recursively) is {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">recurse_files</span><span class="p">.</span><span class="n">len</span><span class="p">());</span><span class="w"></span>
</code></pre></div>

<p>It's directories all the way down! Let's see what Rudgal got as a result.</p>
<div class="highlight"><pre><span></span><code>The number of files <span class="o">(</span>recursively<span class="o">)</span> is <span class="m">24038</span>
</code></pre></div>

<p>Much better! Now he can be sure he didn't miss any files. He's a bit of a shutterbug.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Rust does not (at the time of writing) specifically
optimise Recursive operations like other languages might. In a lot of cases you can see up to three times performance improvements just by doing things iteratively.</p>
<p>Choose whichever pattern is appropriate for what is required.</p>
</div>
<h1>Conclusion</h1>
<p>This is the end of the first dive into the world of <code>std::fs</code>. If you'd like to try out the code used in this post, it's posted <a href="https://github.com/slyons/rust-module-of-the-week/blob/main/rmotw/examples/std_fs_1.rs" title="here">here</a>.</p>
<h1>Next week</h1>
<p>Stay tuned for next week when we'll continue exploring <code>std::fs</code>, more specifically focusing on creating directories and moving files around.</p>
  </article>
  
<div class="well">
    <div class="col-md-3">
    </div>
    <div class="col-md-6">
    <h6 class="text-center">This post is part 1 of the "std::fs" series</h6>
    </div>
    <div class="col-md-3">
        <a href='https://motw.rs/blog/2021/08/08/stdfs-part-2-dirs-dirs-dirs/'>std::fs (Part 2): Dirs, Dirs, Dirs</a>
    </div>
</div>

  <a href="https://github.com/slyons/rust-module-of-the-week/edit/main/content/2021/08/2021-08-01-rmotw.md">Edit this page on Github</a>

<nav class="post-neighbors">

  <a class="neighbor next-article" href="https://motw.rs/blog/2021/08/08/stdfs-part-2-dirs-dirs-dirs/">
    <span class="neighbor-content">
      <span class="neighbor-label">Next:</span>
      <span class="neighbor-title">std::fs (Part 2): Dirs, Dirs, Dirs</span>
    </span>
    <span class="neighbor-arrow">»</span>
  </a>
</nav>
</div>
      </div>
    </div>

    <footer>
      <div class="container wrapper">
        <div class="row">
          <div class="col-sm-6 col-xs-12">
            <ul class="list-unstyled">
              <li><a href="https://motw.rs/blog/archives/index.html">past issues</a></li>
              <li><a href="https://motw.rs/feeds/all.atom.xml">atom feed</a></li>
              <li><a href="https://motw.rs/rss.xml">rss feed</a></li>
              <li><a href="https://github.com/slyons/rust-module-of-the-week">source code</a></li>
            </ul>
          </div>
          <div class="col-sm-6 col-xs-12 text-right custom-xs-text-left">
            <ul class="list-unstyled">
              <li><a href="https://motw.rs/pages/privacy-policy.html">privacy policy</a></li>
              <li><a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">cc-by-sa-4.0</a></li>
            </ul>
          </div>
        </div>
      </div>
    </footer>
  </body>
</html>